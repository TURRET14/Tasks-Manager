<h1>Простой менеджер задач.</h1>

Backend - FastAPI, Работа с БД, Модели ORM - SQLAlchemy

БД - PostgreSQL

Frontend - HTML, CSS, JS


Функционал:
1. Регистрация пользователей.
2. Авторизация пользователей.
3. Просмотр задач.
4. Создание задач.
5. Изменение задач.
6. Удаление задач.
7. Сортировка задач по дате и по статусу.
8. Фильтрация задач по дате и по статусу.

У каждой задачи может быть название, текст и статус. Уникальный ID и дата создания заполняются автоматически на сервере.

Для сортировки задач по дате или по статусу нужно нажать на соответствующий заголовок таблицы.

В меню фильтрации можно сортировать как по одному параметру, так и по обоим. Для применения фильтрации нужно нажать на кнопку фильтровать.

Получить доступ или изменить чужие задачи невозможно.

Пароли хешируются с помощью алгоритма bcrypt с добавлением случайной соли.

Реализована система JWT токенов.

Для изменения задачи нужно нажать на нее, появится соответствующее модальное окно. Тут же можно и удалить задачу.

Для добавления задачи нужно нажать на соответствующую кнопку сверху страницы, появится соответствующее модальное окно.


<h2>Страница авторизации</h2>


![](https://github.com/TURRET14/Img-Storage/blob/main/Login.png)

<h2>Главная страница</h2>

![](https://github.com/TURRET14/Img-Storage/blob/main/Main.png)

<h2>Диалог добавления задачи</h2>

![](https://github.com/TURRET14/Img-Storage/blob/main/Add.png)

<h2>Диалог изменения задачи</h2>

![](https://github.com/TURRET14/Img-Storage/blob/main/Change.png)


<h1>Краткая документация API.</h1>

Объект класса FastAPI - app. Пример запуска: uvicorn main:app


<h3>Формат Payload JWT токена:</h3>
{
"user_id": <ID пользователя>,
"exp": <Время истечения токена>
}


<h3>Формат .env файла:</h3>

SECRET_KEY=<Секретный ключ, используемый JWT>

ALGORITHM=<Алгоритм, используемый JWT>

ACCESS_TOKEN_EXPIRE_MINUTES=<Время истечения JWT токена>

SQLALCHEMY_DATABASE_URL=<Строка подключения к БД>


<h2>Endpoints:</h2>
<h2>Frontend:</h2>

<h3>1. @app.get("/")</h3>

Возвращает главную страницу.

Параметры: Нет

<h3>2. @app.get("/login")</h3>

Возвращает страницу авторизации.

Параметры: Нет

<h2>Backend:</h2>

<h3>1. @app.post("/login")</h3>

Отвечает за логин пользователей в систему. Если все нормально, возвращает JWT токен в заголовке запроса, статусный код 200. Если пароль или логин неверны, возвращает ошибку 401 с соответствующим сообщением. 

Параметры:

login_input = fastapi.Form(min_length=1, max_length=30) - Логин

password_input = fastapi.Form(min_length=6, max_length=30) - Пароль

Зависимости:

db = fastapi.Depends(get_db)) - Получение сессии БД

<h3>2. @app.post("/register")</h3>

Отвечает за регистрацию пользователей. Если все нормально, возвращает JWT токен в заголовке запроса, статусный код 200. Если логин или эл. почта уже заняты, возвращает ошибку 409 с соответствующим сообщением.

Параметры:

login_input = fastapi.Form(min_length=1, max_length=30) - Логин

password_input = fastapi.Form(min_length=6, max_length=30) - Пароль

email_input = fastapi.Form(min_length=1) - Электронная почта

Зависимости:

db = fastapi.Depends(get_db)

<h3>3. @app.get("/tasks")</h3>

Отвечает за получение задач. Выдает задачи того пользователя, ID которого указан в JWT токене со статусным кодом 200, если все нормально. Если JWT токен невалиден/истек - возвращает ошибку 401.

Параметры:

Нет

Зависимости:

token = fastapi.Depends(get_auth_bearer) - Получение JWT Токена из заголовка запроса в формате Authorization: Bearer <JWT>
db = fastapi.Depends(get_db) - Получение сессии БД

<h3>4. @app.post("/tasks")</h3>

Отвечает за добавление новой задачи. Добавляет задачу тому пользователю, ID которого указан в JWT токене, и если операция успешна, возвращает статусный код 200. Если JWT токен невалиден/истек - возвращает ошибку 401.

Параметры:

data = fastapi.Body() - Тело запроса

Формат:

{
"header": <Текст заголовка задачи>,
"text": <Текст задачи>,
"status_id": <ID статуса задачи>
}

Зависимости:

token = fastapi.Depends(get_auth_bearer) - Получение JWT Токена из заголовка запроса в формате Authorization: Bearer <JWT>

db = fastapi.Depends(get_db)) - Получение сессии БД

<h3>5. @app.put("/tasks")</h3>

Отвечает за изменение существующей задачи. Из тела запроса получает ID задачи и ее новые данные. Если эта задача не принадлежит пользователю, ID которого указан в JWT токене, возвращает статусный код 403. Если токен невалиден/истек - возвращает статусный код 401. Если заметка не найдена - возвращает статусный код 404. Если операция завершается успешно, возвращает статусный код 200. 

Параметры:

data = fastapi.Body() - Тело запроса

Формат:

{
"id": <ID задачи>,
"header": <Текст заголовка задачи>,
"text": <Текст задачи>,
"status_id": <ID статуса задачи>
}

Зависимости:

token = fastapi.Depends(get_auth_bearer) - Получение JWT Токена из заголовка запроса в формате Authorization: Bearer <JWT>

db = fastapi.Depends(get_db)) - Получение сессии БД

<h3>6. @app.delete("/tasks")</h3>

Отвечает за удаление существующей задачи. Из тела запроса получает ID задачи для удаления. Если эта задача не принадлежит пользователю, ID которого указан в JWT токене, возвращает статусный код 403. Если токен невалиден/истек - возвращает статусный код 401. Если заметка не найдена - возвращает статусный код 404. Если операция завершается успешно, возвращает статусный код 200.

Параметры:

data = fastapi.Body() - Тело запроса

Формат:

{
"id": <ID задачи>
}

Зависимости:

token = fastapi.Depends(get_auth_bearer) - Получение JWT Токена из заголовка запроса в формате Authorization: Bearer <JWT>

db = fastapi.Depends(get_db)) - Получение сессии БД


<h1>Комментарии</h1>

Сам API FastAPI вместе со всеми Эндпоинтами находится в файле main.py

В файле db.py находятся модели ORM двух таблиц - users и tasks в виде классов Users и Tasks соответственно. Так же там находится движок и генератор сессий, который используется в зависимостях Эндпоинтов.

Строка подключения к БД находится в .env файле.

В файле jwt_encode_decode.py находится функции encode_jwt и decode_jwt. Первая служит для создания JWT токена с добавлением времени его истечения. Вторая для проверки валидности JWT токена и получения из него информации.

Так же тут находится зависимость get_auth_bearer, которая используется в Эндпоинтах для получения JWT токена из заголовка запроса.

Секретный ключ и алгоритм, как и время истечения так же считываются из .env файла.

Запросы к API на стороне фронтенда выполняются через JS Fetch API.

Модули Python, используемые в проекте:
fastapi, 
uvicorn, 
sqlalchemy, 
python-dotenv, 
pyjwt, 
bcrypt, 
psycopg2-binary, 
python-multipart

Используемая версия языка - Python 3.13
Скрипт SQL для создания таблиц, с которыми работает сервис приложен в файле init.sql. Именно он используется при создании контейнера Docker PostgreSQL.

Также приложен файл Dockerfile, который создает образ Docker для данного проекта. И docker-compose.yml, который отвечает за сетевое взаимодействие и создание двух контейнеров - данного веб-сервиса и PostgreSQL с совместимой базой данных. После создания и запуска контейнеров к сайту можно получить доступ по адресу localhost:8000

Файл с требуемыми зависимостями Python requirements.txt также приложен.

Ссылка на уже созданный образ проекта на Docker Hub: https://hub.docker.com/repository/docker/turret14/task_manager/general
